# Don't filter! Keep all data for comparison
# Convert to numeric
monocentric_2016 <- monocentric_2016 %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Convert to numeric
monocentric_2016_2 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
monocentric_2016_2 <- read_csv("monocentric_2016.csv") %>%
mutate(pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd),
hhsize = as.numeric(hhsize),
popdens = as.numeric(popdens),
shhistdistr = as.numeric(shhistdistr))
monocentric_2016_2$nijmegen <- ifelse(monocentric_2016_2$munname == "Nijmegen", 1, 0)
model_3 <- lm(pricem2 ~ distcbd, data=data)
summary(model_3)
# Don't filter! Keep all data for comparison
# Convert to numeric
monocentric_2016_2 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Create Nijmegen dummy
monocentric_2016_2$nijmegen <- ifelse(monocentric_2016_2$munname == "Nijmegen", 1, 0)
monocentric_2016_2$nijmegen <- as.factor(monocentric_2016_2$nijmegen)
# Now use the FULL dataset for regression
data <- monocentric_2016_2 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# Run the model
model_2 <- lm(pricem2 ~ distcbd + nijmegen + distcbd:nijmegen, data = data)
summary(model_2)
model_3 <- lm(pricem2 ~ distcbd + nijmegen + distcbd:nijmegen, data = data)
summary(model_3)
# Convert to numeric
monocentric_2016_2 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Create Nijmegen dummy
monocentric_2016_2$nijmegen <- ifelse(monocentric_2016_2$munname == "Nijmegen", 1, 0)
monocentric_2016_2$nijmegen <- as.factor(monocentric_2016_2$nijmegen)
# Now use the FULL dataset for regression
data_full <- monocentric_2016_2 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# Run the model
model_3 <- lm(pricem2 ~ distcbd + nijmegen + distcbd:nijmegen, data = data)
summary(model_3)
ggplot() +
geom_point(data=data_full)
#Plot
ggplot() +
geom_point(data=data_full)
#Plot
ggplot() +
geom_point(data=data_full,
aes(x = distcbd, y = pricem2, color = nijmegen))
#Plot
ggplot() +
geom_point(data=data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha=0.5)
pred_data <- expand.grid(
distcbd = seq(min(data_full$distcbd), max(data_full$distcbd), length.out = 200),
nijmegen = levels(data_full$nijmegen)
)
pred_data$pred <- predict(model_interact, newdata = pred_data)
#Plot
ggplot() +
geom_point(data=data_full,
aes(x = distcbd, y = pricem2, color = nijmegen)) +
geom_line(data = pred_data)
#Plot
ggplot() +
geom_point(data=data_full,
aes(x = distcbd, y = pricem2, color = nijmegen))
# Data opnieuw inlezen
monocentric_2016 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Dummy voor Nijmegen
monocentric_2016$nijmegen <- ifelse(monocentric_2016$munname == "Nijmegen", 1, 0)
monocentric_2016$nijmegen <- as.factor(monocentric_2016$nijmegen)
# Verwijder NA's
data_full <- monocentric_2016 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# Regressie met interactie
model_interact <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
summary(model_interact)
# Plot interactie
plot_model(model_interact, type = "pred", terms = c("distcbd", "nijmegen"))
# Plotdata voorspellen uit het model
pred_data <- expand.grid(
distcbd = seq(min(data_full$distcbd), max(data_full$distcbd), length.out = 200),
nijmegen = levels(data_full$nijmegen)
)
pred_data$pred <- predict(model_interact, newdata = pred_data)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
size = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Data opnieuw inlezen
monocentric_2016 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Dummy voor Nijmegen
monocentric_2016$nijmegen <- ifelse(monocentric_2016$munname == "Nijmegen", 1, 0)
monocentric_2016$nijmegen <- as.factor(monocentric_2016$nijmegen)
# Verwijder NA's
data_full <- monocentric_2016 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# Regressie met interactie
model_interact <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
summary(model_interact)
# Plot interactie
plot_model(model_interact, type = "pred", terms = c("distcbd", "nijmegen"))
# Plotdata voorspellen uit het model
pred_data <- expand.grid(
distcbd = seq(min(data_full$distcbd), max(data_full$distcbd), length.out = 200),
nijmegen = levels(data_full$nijmegen)
)
pred_data$pred <- predict(model_interact, newdata = pred_data)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Data opnieuw inlezen
monocentric_2016 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Dummy voor Nijmegen
monocentric_2016$nijmegen <- ifelse(monocentric_2016$munname == "Nijmegen", 1, 0)
monocentric_2016$nijmegen <- as.factor(monocentric_2016$nijmegen)
# Verwijder NA's
data_full <- monocentric_2016 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# Regressie met interactie
model_interact <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
summary(model_interact)
# Plot interactie
plot_model(model_interact, type = "pred", terms = c("distcbd", "nijmegen"))
# Plotdata voorspellen uit het model
pred_data <- expand.grid(
distcbd = seq(min(data_full$distcbd), max(data_full$distcbd), length.out = 200),
nijmegen = levels(data_full$nijmegen)
)
pred_data$pred <- predict(model_interact, newdata = pred_data)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Maak Nijmegen dummy als factor
monocentric_2016$nijmegen <- ifelse(monocentric_2016$munname == "Nijmegen", 1, 0)
monocentric_2016$nijmegen <- factor(monocentric_2016$nijmegen, levels = c(0,1),
labels = c("NietNijmegen", "Nijmegen"))
# Verwijder rijen met missings in de relevante variabelen
data_full <- monocentric_2016 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# ---------- 1) Basis specificatie: lineair ----------
model_linear <- lm(pricem2 ~ distcbd, data = data_full)
summary(model_linear)
# ---------- 2) Alternatieve spec: log-lineair (voorkomt heteroscedasticiteit en interpreteerbaar in %)
# Alleen toepassen als pricem2 > 0 (controleer dat)
sum(data_full$pricem2 <= 0, na.rm = TRUE) # zou 0 moeten geven
model_log <- lm(log(pricem2) ~ distcbd, data = data_full)
summary(model_log)
# ---------- 3) Vergelijking Nijmegen vs rest: interactiemodel ----------
# nijmegen is factor met twee levels; gebruik distcbd * nijmegen om main + interactie te krijgen
model_interact <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
summary(model_interact)
# ---------- 4) Tabel exporteren met stargazer (basis en interactie) ----------
library(stargazer)
stargazer(model_linear, model_log, model_interact,
type = "text",
keep.stat = c("n","rsq","adj.rsq","f"),
covariate.labels = c("Afstand tot CBD (km)",
"Nijmegen (dummy)",
"Afstand × Nijmegen"),
dep.var.labels = c("Prijs per m2", "Log(prijs per m2)", "Prijs per m2"),
title = "Regressie-uitkomsten: prijs per m2 vs afstand tot CBD")
# ---------- 5) Hypothesetoets (éénzijdig: afstand heeft negatief effect) ----------
# Gebruik de twee-zijdige p-waarde uit summary; voor éénzijdig p_one_sided = p_two_sided/2 als teken klopt.
coef_summary <- summary(model_linear)$coefficients
beta_dist <- coef_summary["distcbd","Estimate"]
p_two_sided <- coef_summary["distcbd","Pr(>|t|)"]
p_one_sided <- p_two_sided / 2
beta_dist; p_two_sided; p_one_sided
# Data opnieuw inlezen
monocentric_2016 <- read_csv("monocentric_2016.csv") %>%
mutate(
pricem2 = as.numeric(pricem2),
distcbd = as.numeric(distcbd)
)
# Dummy voor Nijmegen
monocentric_2016$nijmegen <- ifelse(monocentric_2016$munname == "Nijmegen", 1, 0)
monocentric_2016$nijmegen <- as.factor(monocentric_2016$nijmegen)
# Verwijder NA's
data_full <- monocentric_2016 %>%
filter(!is.na(pricem2), !is.na(distcbd))
# Regressie met interactie
model_interact <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
summary(model_interact)
# Plot interactie
plot_model(model_interact, type = "pred", terms = c("distcbd", "nijmegen"))
# Plotdata voorspellen uit het model
pred_data <- expand.grid(
distcbd = seq(min(data_full$distcbd), max(data_full$distcbd), length.out = 200),
nijmegen = levels(data_full$nijmegen)
)
pred_data$pred <- predict(model_interact, newdata = pred_data)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
linewidth = 1.2) +
scale_color_manual(values = c("black", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = "blue"),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = nijmegen),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = "black"),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, color = "black"),
linewidth = 1.2) +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Gemeente"
) +
theme_minimal(base_size = 14)
# Mooie ggplot-interactieplot
ggplot() +
geom_point(data = data_full,
aes(x = distcbd, y = pricem2, color = nijmegen),
alpha = 0.5) +
geom_line(data = pred_data,
aes(x = distcbd, y = pred, linetype = nijmegen),
linewidth = 1.2,
color = "black") +
scale_color_manual(values = c("darkgrey", "red"),
labels = c("Niet Nijmegen", "Nijmegen")) +
scale_linetype_manual(values = c("solid", "dashed")) +
labs(
title = "Interactiemodel: afstand tot CBD × Nijmegen",
subtitle = "Verschillende regressielijnen per gemeente",
x = "Afstand tot CBD (km)",
y = "Prijs per m² (€)",
color = "Punten (gemeente)",
linetype = "Lijnen (gemeente)"
) +
theme_minimal(base_size = 14)
summary(model_interact)
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + pop_density, data = data_full)
stargazer(basic_model, extended_model,
type = "text",
title = "Regression Results: Basic vs Extended Model",
column.labels = c("Basic", "Extended"),
covariate.labels = c("Intercept", "Distance to CBD", "Nijmegen",
"Distance:Nijmegen", "Population density"),
omit.stat = c("f", "ser"),
no.space = TRUE)
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + pop_density, data = data_full)
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + popdens, data = data_full)
stargazer(basic_model, extended_model,
type = "text",
title = "Regression Results: Basic vs Extended Model",
column.labels = c("Basic", "Extended"),
covariate.labels = c("Intercept", "Distance to CBD", "Nijmegen",
"Distance:Nijmegen", "Population density"),
omit.stat = c("f", "ser"),
no.space = TRUE)
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + popdens, data = data_full)
stargazer(basic_model, extended_model,
type = "text",
title = "Regression Results: Basic vs Extended Model",
column.labels = c("Basic", "Extended"),
covariate.labels = c("Intercept", "Distance to CBD", "Nijmegen",
"Distance:Nijmegen", "Population density"),
omit.stat = c("f", "ser"),
no.space = TRUE)
stargazer(basic_model, extended_model,
type="text",
column.labels=c("Basic","Extended"),
dep.var.labels="pricem2",
keep=c("distcbd","nijmegen","distcbd:nijmegen","popdens"),
covariate.labels=c("Distance to CBD","Nijmegen","Distance:Nijmegen","Population density"))
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + popdens, data = data_full)
stargazer(basic_model, extended_model,
type="text",
column.labels=c("Basic","Extended"),
dep.var.labels="pricem2",
keep=c("distcbd","nijmegen","distcbd:nijmegen","popdens"),
covariate.labels=c("Distance to CBD","Nijmegen","Distance:Nijmegen","Population density"))
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + popdens, data = data_full)
stargazer(basic_model, extended_model,
type="text",
column.labels = c("Basic","Extended"),
dep.var.labels = "pricem2",
covariate.labels = c(
"(Intercept)",
"Distance to CBD",
"Nijmegen",
"Distance × Nijmegen",
"Population density"
),
keep.stat = c("n", "rsq", "adj.rsq"))
summary(basic_model)
summary(extended_model)
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + popdens, data = data_full)
stargazer(
basic_model,
extended_model,
type = "text",
column.labels = c("Basic", "Extended"),
dep.var.labels = "pricem2",
covariate.labels = c("Intercept", "Distance to CBD", "Nijmegen",
"Distance × Nijmegen", "Population density")
)
basic_model <- lm(pricem2 ~ distcbd * nijmegen, data = data_full)
extended_model <- lm(pricem2 ~ distcbd * nijmegen + popdens, data = data_full)
stargazer(
basic_model,
extended_model,
type = "text",
column.labels = c("Basic", "Extended"),
dep.var.labels = "pricem2",
covariate.labels = list(
c("Intercept", "Distance to CBD", "Nijmegen", "Distance × Nijmegen"),
c("Intercept", "Distance to CBD", "Nijmegen", "Population density", "Distance × Nijmegen")
)
)
data_full$distance <- data_full$distcbd
data_full$nijmegen_dummy <- data_full$nijmegen
data_full$d_interaction <- data_full$distcbd * data_full$nijmegen
data_full$population_density <- data_full$popdens
basic_model <- lm(pricem2 ~ distance * nijmegen_dummy, data = data_full)
extended_model <- lm(pricem2 ~ distance * nijmegen_dummy + population_density,
data = data_full)
stargazer(
basic_model,
extended_model,
type = "text",
column.labels = c("Basic", "Extended"),
dep.var.labels = "Price per m2"
)
